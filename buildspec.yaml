version: 0.2

env:
  variables:
    SOLUTION_FILE: "src/sample-eval.sln"
    PACKAGE_LOCATION: "src/sample-eval/publish"

phases:
  install:
    runtime-versions:
      dotnet: 4.8

  pre_build:
    commands:
      - nuget restore $env:SOLUTION_FILE

  build:
    commands:
      - |
        & "C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\MSBuild\Current\Bin\MSBuild.exe" $env:SOLUTION_FILE `
        /p:Configuration=Release `
        /p:DeployOnBuild=true `
        /p:WebPublishMethod=Package `
        /p:PackageAsSingleFile=true `
        /p:SkipInvalidConfigurations=true `
        /p:PackageLocation="$env:PACKAGE_LOCATION"

artifacts:
  files:
    - $env:PACKAGE_LOCATION/sample-eval.zip
  name: dotnet-app
